---
alias: 
发布时间: 
出品方: 快手
价值: ⭐⭐⭐⭐
---
环节:: 
关键词:: #Reco/新物料冷启

---

# [快手视频冷启动优化介绍](https://docs.corp.kuaishou.com/file/fcACjM_7FVHSC2iZpc6Mo88-J)

## 概述

* 第一阶段，就是每个视频都有固定的冷启曝光量的额度，来了一个请求，就随机分配一个需要冷启的视频。其实也没必要这么粗，根据用户tag和冷启物料的tag做一些定向也好。但是看实验结果，好像也没啥太大的效果。
* 第二阶段，采取类似保量投放广告“流量分配”的算法

  * 求解问题时，需要评价给第i次请求展示第j个物料的收益$w_{ij}$，用双塔来预估ij之间的匹配度
  * 离线优化问题求解，参考SHALE: An Efficient Algorithm for Allocation of Guaranteed Display Advertising
  * Optimal Online Assignment with Forecasts, 提供方法，可以用离线解代替在线解
* 第三阶段，

  * 首先，之前阶段，$d_j$即第j个视频的冷启流量额度是固定的，这次改成“构建**视频质量分**，融合**冷启流量表现不断修正**，不同视频获得**不同冷启流量**”

    * 先建立一个模型，预测视频质量得分
    * 根据视频质量分分桶，在不同质量分分桶内，根据统计数据拟合ctr后验分布
    * 根据ctr后验分布，确定$d_j$（流量分发上限）
    * 根据质量分-->ctr后验分布，如果从这个后验分布中连续多次采样出一个极小的ctr，则投放该视频的过程**early stop**
  * 其次，提升双塔预估$w_{ij}$的准确度

    * 将图像embedding加入user（average pooling）和item侧
    * 多加一些label（但是label之间不迁移的话，反而有害吧）
* 未来

  * 流量分配上，同品类内部，优化流量上限
  * 冷启专用模型预估$w_{ij}$，强化低曝光样本


## 基础

* 来了一个请求，既走正常推荐流程，也走冷启流程，最后再融合
* 冷启动会筛选视频，只有质量好的，才进入索引，用于正常流量的分发
* 选拔性：提高流量分配效率，用最合理的流量筛选出优质作品

  * XX-vv出坡数：新上传作品中，在发布N天（e.g. 2天）后，能够获取到XX（e.g., 10000）个曝光的视频数量
* 尽力提高冷启动流量的消费体验

## 第一阶段：随机分发

纯随机分发

* 画一个轮盘，如果有5个item要分发，那么这个轮盘会被切分成5个扇形
* 但是每个扇形的面积大小不一致，流量缺口越大的item所占的面积越大
* 来了一个冷启动请求，产生随机数，看看落到哪个扇形，就将对应扇形对应的视频分发出去

其实可以做一些定向，比如不一定所有冷启item要争抢同一个轮盘。可以根据photo tag建立不同的轮盘，来一个请求后，根据用户上的tag，到不同的轮盘上去随机找来视频。

## 第二阶段：基于匹配的冷启优化

* 为提升选拔性，引入带约束的二分图匹配
* 为提升用户消费体验，引入双塔预估

数学表达

![image.png | 200](assets/image-20220104163605-0gxi8f3.png)

![image.png | 300](assets/image-20220104164810-2ckpb8j.png)  
**dj应该是“期望曝光量”与“实际曝光量”之间的diff**

![image.png | 300](assets/image-20220106094321-o48juco.png)

为了求解方便，进行如下优化  

* 原来要求$x_{ij}$必须是0/1整数，这个要求太强，这里把整数约束放宽，只要求$x_{ij}\ge0$，还是能够保证$x_{ij}\le1$的，因为还有![image.png | 100](assets/image-20220104165239-117npol.png)
* 加入正则，变成凸二次规划问题，也就是第i次请求是否展示第j个物料的概率，应该与第j个物料所需要的冷启动流量占整体冷启流量的占比差不多Å

再利用Lagrangian求解

![image.png | 500](assets/image-20220106095319-w789iiv.png)
