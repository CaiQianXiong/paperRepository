---
alias: HMoE
发布时间: 2020-01-01
出品方: 阿里
价值: ⭐⭐⭐
---

环节:: 精排
关键词:: #Reco/多场景推荐 

---

# [Improving Multi-Scenario Learning to Rank in E-commerce by Exploiting Task Relationships in the Label Space](https://cs.nju.edu.cn/_upload/tpl/01/0c/268/template268/pdf/CIKM-2020-Li.pdf)
阿里 CIKM 2020 #Reco/多场景推荐

场景与我们的很类似，就是一个多国推荐的场景。每个国家训练一个模型，维护起来太麻烦，况且还有的国家数据非常少。


![image.png | 300](assets/image-20220106153606-9u3umla.png)

其实说白了，就是每个国家有自己的dnn，单一国家用户的样本要被所有国家的dnn打分，在这上面再有一个gate，将这些打分做一个融合。“we utilize a stacked approach to learn how the prediction of one scenario can be **rectified** by predictions of others”

* 底层是一个MoE，不重要
* 看这幅图，任何一个样本，都要被所有国家的dnn打分一遍，图中的$S_1...S_T$（这国家如果太多了，线上耗时也太大了吧）
* 图中展示是一个两步走的stacking model，训练W时就已经是另外一个模型了，不会影响staging 1各模型的参数了
* 但是这**种两步走方式太麻烦，被下面的end-to-end方式取代**。


![image.png | 300](assets/image-20220106154600-428hmke.png)

![image.png | 300](assets/image-20220106154631-q0icup5.png)

说白了，原理就一条，训练时，尽管每条样本都要被所有国家的dnn打分，但是country=t的样本，**只能对产生$S_t$的dnn回传梯度，对其他国家绝对应该stop gradient**